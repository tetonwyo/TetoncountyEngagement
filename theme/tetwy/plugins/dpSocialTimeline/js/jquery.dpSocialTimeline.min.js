(function(e){function t(t,n){this.timeline=e(t);this.settings=e.extend({},e.fn.dpSocialTimeline.defaults,n);var r=this.settings.feeds;var i=this.settings.custom;this.feeds=new Array;this.custom=new Array;this.social=new Array;for(x in this.settings.feeds){this.feeds[x+"_arr"]=r[x].data.split(",");if(typeof r[x].limit!=="undefined"){try{if(isNaN(r[x].limit)){this.feeds[x+"_limit"]=r[x].limit.split(",")}else{this.feeds[x+"_limit"]=r[x].limit}}catch(s){}}if(typeof this.feeds[x+"_limit"]==="undefined"){this.feeds[x+"_limit"]=0}this.feeds[x+"_url"]=new Array}for(x in this.settings.custom){this.custom[x+"_url"]=new Array(i[x].url);this.custom[x+"_name"]=new Array(i[x].name);this.custom[x+"_icon"]=new Array(i[x].icon);this.custom[x+"_limit"]=i[x].limit;this.social.push({name:this.custom[x+"_name"],url:this.custom[x+"_url"],id:x,icon:this.custom[x+"_icon"],limit:this.custom[x+"_limit"]})}this.totalFeeds=0;this.resizeTimer;this.nameFeeds=new Array;this.iconFeeds=new Array;this.limitFeeds=new Array;this.entry=new Array;this.settings.itemWidthOrig=this.settings.itemWidth;var o=new String(window.document.location);if(o.indexOf("https://")!=-1)this.prefix="https://";else this.prefix="http://";switch(this.settings.layoutMode){case"timeline":this.settings.layoutMode="spineAlign";if(this.settings.timelineItemWidth!=""){this.settings.itemWidth=this.settings.timelineItemWidth}break;case"columns":this.settings.layoutMode="masonry";if(this.settings.columnsItemWidth!=""){this.settings.itemWidth=this.settings.columnsItemWidth}break;case"one_column":this.settings.layoutMode="straightDown";if(this.settings.oneColumnItemWidth!=""){this.settings.itemWidth=this.settings.oneColumnItemWidth}break}this.lastLayout=this.settings.layoutMode;this.timeline.addClass(this.settings.skin);this.init()}t.prototype={init:function(){var t=this;if(this.feeds["twitter_arr"]){for(var n=0;n<this.feeds["twitter_arr"].length;n++){this.feeds["twitter_url"][n]=e.trim(this.feeds["twitter_arr"][n])+"&t="+(new Date).getTime()}this.social.push({name:this.feeds["twitter_arr"],url:this.feeds["twitter_url"],id:"twitter",icon:"",limit:this.feeds["twitter_limit"]})}if(this.feeds["twitter_hash_arr"]){for(var n=0;n<this.feeds["twitter_hash_arr"].length;n++){this.feeds["twitter_hash_url"][n]=e.trim(this.feeds["twitter_hash_arr"][n])+"&t="+(new Date).getTime()}this.social.push({name:this.feeds["twitter_hash_arr"],url:this.feeds["twitter_hash_url"],id:"twitter",icon:"",limit:this.feeds["twitter_hash_limit"]})}if(this.feeds["lastfm_tracks_arr"]){for(var n=0;n<this.feeds["lastfm_tracks_arr"].length;n++){this.feeds["lastfm_tracks_url"][n]="http://ws.audioscrobbler.com/1.0/user/"+e.trim(this.feeds["lastfm_tracks_arr"][n])+"/recenttracks.rss"}this.social.push({name:this.feeds["lastfm_tracks_arr"],url:this.feeds["lastfm_tracks_url"],id:"lastfm",icon:"",limit:this.feeds["lastfm_tracks_limit"]})}if(this.feeds["lastfm_events_arr"]){for(var n=0;n<this.feeds["lastfm_events_arr"].length;n++){this.feeds["lastfm_events_url"][n]="http://ws.audioscrobbler.com/1.0/user/"+e.trim(this.feeds["lastfm_events_arr"][n])+"/events.rss"}this.social.push({name:this.feeds["lastfm_events_arr"],url:this.feeds["lastfm_events_url"],id:"lastfm",icon:"",limit:this.feeds["lastfm_events_limit"]})}if(this.feeds["lastfm_loved_arr"]){for(var n=0;n<this.feeds["lastfm_loved_arr"].length;n++){this.feeds["lastfm_loved_url"][n]="http://ws.audioscrobbler.com/2.0/user/"+e.trim(this.feeds["lastfm_loved_arr"][n])+"/lovedtracks.rss"}this.social.push({name:this.feeds["lastfm_loved_arr"],url:this.feeds["lastfm_loved_url"],id:"lastfm",icon:"",limit:this.feeds["lastfm_loved_limit"]})}if(this.feeds["lastfm_artist_events_arr"]){for(var n=0;n<this.feeds["lastfm_artist_events_arr"].length;n++){this.feeds["lastfm_artist_events_url"][n]="http://ws.audioscrobbler.com/1.0/artist/"+e.trim(this.feeds["lastfm_artist_events_arr"][n])+"/events.rss"}this.social.push({name:this.feeds["lastfm_artist_events_arr"],url:this.feeds["lastfm_artist_events_url"],id:"lastfm",icon:"",limit:this.feeds["lastfm_artist_events_limit"]})}if(this.feeds["lastfm_journal_arr"]){for(var n=0;n<this.feeds["lastfm_journal_arr"].length;n++){this.feeds["lastfm_journal_url"][n]="http://ws.audioscrobbler.com/1.0/user/"+e.trim(this.feeds["lastfm_journal_arr"][n])+"/journals.rss"}this.social.push({name:this.feeds["lastfm_journal_arr"],url:this.feeds["lastfm_journal_url"],id:"lastfm",icon:"",limit:this.feeds["lastfm_journal_limit"]})}if(this.feeds["google_arr"]){for(var n=0;n<this.feeds["google_arr"].length;n++){this.feeds["google_url"][n]=e.trim(this.feeds["google_arr"][n])}this.social.push({name:this.feeds["google_arr"],url:this.feeds["google_url"],id:"google",icon:"",limit:this.feeds["google_limit"]})}if(this.feeds["instagram_arr"]){for(var n=0;n<this.feeds["instagram_arr"].length;n++){this.feeds["instagram_url"][n]="http://widget.stagram.com/rss/n/"+e.trim(this.feeds["instagram_arr"][n]+"/")}this.social.push({name:this.feeds["instagram_arr"],url:this.feeds["instagram_url"],id:"instagram",icon:"",limit:this.feeds["instagram_limit"]})}if(this.feeds["instagram_hash_arr"]){for(var n=0;n<this.feeds["instagram_hash_arr"].length;n++){this.feeds["instagram_hash_url"][n]="http://instagram.com/tags/"+e.trim(this.feeds["instagram_hash_arr"][n])+"/feed/recent.rss"}this.social.push({name:this.feeds["instagram_hash_arr"],url:this.feeds["instagram_hash_url"],id:"instagram",icon:"",limit:this.feeds["instagram_hash_limit"]})}if(this.feeds["soundcloud_arr"]){for(var n=0;n<this.feeds["soundcloud_arr"].length;n++){this.feeds["soundcloud_url"][n]="http://picklemonkey.net/cloudflipper/cloudflipper.php?feed=https://soundcloud.com/"+e.trim(this.feeds["soundcloud_arr"][n])}this.social.push({name:this.feeds["soundcloud_arr"],url:this.feeds["soundcloud_url"],id:"soundcloud",icon:"https://a2.sndcdn.com/assets/images/sc-icons/favicon-154f6af5.ico",limit:this.feeds["soundcloud_limit"]})}if(this.feeds["facebook_page_arr"]){for(var n=0;n<this.feeds["facebook_page_arr"].length;n++){this.feeds["facebook_page_url"][n]="http://www.facebook.com/feeds/page.php?id="+e.trim(this.feeds["facebook_page_arr"][n])+"&format=atom10"}this.social.push({name:this.feeds["facebook_page_arr"],url:this.feeds["facebook_page_url"],id:"facebook",icon:"",limit:this.feeds["facebook_page_limit"]})}if(this.feeds["delicious_arr"]){for(var n=0;n<this.feeds["delicious_arr"].length;n++){this.feeds["delicious_url"][n]="http://feeds.delicious.com/v2/rss/"+e.trim(this.feeds["delicious_arr"][n])}this.social.push({name:this.feeds["delicious_arr"],url:this.feeds["delicious_url"],id:"delicious",icon:"",limit:this.feeds["delicious_limit"]})}if(this.feeds["flickr_arr"]){for(var n=0;n<this.feeds["flickr_arr"].length;n++){this.feeds["flickr_url"][n]="http://api.flickr.com/services/feeds/photos_public.gne?id="+e.trim(this.feeds["flickr_arr"][n])+"&format=rss_200"}this.social.push({name:this.feeds["flickr_arr"],url:this.feeds["flickr_url"],id:"flickr",icon:"",limit:this.feeds["flickr_limit"]})}if(this.feeds["flickr_hash_arr"]){for(var n=0;n<this.feeds["flickr_hash_arr"].length;n++){this.feeds["flickr_hash_url"][n]="http://api.flickr.com/services/feeds/photos_public.gne?tags="+e.trim(this.feeds["flickr_hash_arr"][n])+"&lang=es-us&format=rss_200"}this.social.push({name:this.feeds["flickr_hash_arr"],url:this.feeds["flickr_hash_url"],id:"flickr",icon:"",limit:this.feeds["flickr_hash_limit"]})}if(this.feeds["tumblr_arr"]){for(var n=0;n<this.feeds["tumblr_arr"].length;n++){this.feeds["tumblr_url"][n]="http://"+e.trim(this.feeds["tumblr_arr"][n])+".tumblr.com/rss"}this.social.push({name:this.feeds["tumblr_arr"],url:this.feeds["tumblr_url"],id:"tumblr",icon:"",limit:this.feeds["tumblr_limit"]})}if(this.feeds["youtube_arr"]){for(var n=0;n<this.feeds["youtube_arr"].length;n++){this.feeds["youtube_url"][n]="http://gdata.youtube.com/feeds/base/users/"+e.trim(this.feeds["youtube_arr"][n])+"/uploads"}this.social.push({name:this.feeds["youtube_arr"],url:this.feeds["youtube_url"],id:"youtube",icon:"",limit:this.feeds["youtube_limit"]})}if(this.feeds["youtube_search_arr"]){for(var n=0;n<this.feeds["youtube_search_arr"].length;n++){this.feeds["youtube_search_url"][n]="http://gdata.youtube.com/feeds/api/videos?alt=atom&racy=include&vq="+e.trim(this.feeds["youtube_search_arr"][n])}this.social.push({name:this.feeds["youtube_search_arr"],url:this.feeds["youtube_search_url"],id:"youtube",icon:"",limit:this.feeds["youtube_search_limit"]})}if(this.feeds["dribbble_arr"]){for(var n=0;n<this.feeds["dribbble_arr"].length;n++){this.feeds["dribbble_url"][n]="http://dribbble.com/players/"+e.trim(this.feeds["dribbble_arr"][n])+"/shots.rss"}this.social.push({name:this.feeds["dribbble_arr"],url:this.feeds["dribbble_url"],id:"dribbble",icon:"",limit:this.feeds["dribbble_limit"]})}if(this.feeds["digg_arr"]){for(var n=0;n<this.feeds["digg_arr"].length;n++){this.feeds["digg_url"][n]="http://digg.com/users/"+e.trim(this.feeds["digg_arr"][n])+"/history.rss"}this.social.push({name:this.feeds["digg_arr"],url:this.feeds["digg_url"],id:"digg",icon:"",limit:this.feeds["digg_limit"]})}if(this.feeds["pinterest_arr"]){for(var n=0;n<this.feeds["pinterest_arr"].length;n++){this.feeds["pinterest_url"][n]="http://www.pinterest.com/"+e.trim(this.feeds["pinterest_arr"][n])+"/feed.rss"}this.social.push({name:this.feeds["pinterest_arr"],url:this.feeds["pinterest_url"],id:"pinterest",icon:"",limit:this.feeds["pinterest_limit"]})}if(this.feeds["vimeo_arr"]){for(var n=0;n<this.feeds["vimeo_arr"].length;n++){this.feeds["vimeo_url"][n]="http://vimeo.com/"+e.trim(this.feeds["vimeo_arr"][n])+"/videos/rss"}this.social.push({name:this.feeds["vimeo_arr"],url:this.feeds["vimeo_url"],id:"vimeo",icon:"",limit:this.feeds["vimeo_limit"]})}this.timeline.addClass("dpSocialTimelineLoading");this._parseFeeds();e(window).bind("resize",function(){if(e(window).height()!=t.lastWindowHeight||e(window).width()!=t.lastWindowWidth){t.lastWindowHeight=e(window).height();t.lastWindowWidth=e(window).width();t._updateTimelineSize()}});var r="http://platform.twitter.com/widgets.js";e.getScript(r)},_updateTimelineSize:function(){if(this.timeline.width()<480){e("button",this.timeline).removeClass("active");e(".dpSocialTimeline_layout",this.timeline).hide();if(!this.settings.showFilter||this.totalFeeds==1){e(".dpSocialTimeline_divider",this.timeline).hide()}e(".dpSocialTimeline_lineWrap",this.timeline).fadeOut("fast");e(".dpSocialTimeline_item",this.timeline).css("width","99%");e(".dpSocialTimeline",this.timeline).isotope({layoutMode:"straightDown"})}else if(!e("button."+this.lastLayout,this.timeline).hasClass("active")||this.lastLayout=="straightDown"){if(this.settings.showLayout){e(".dpSocialTimeline_layout",this.timeline).show()}e("button."+this.lastLayout,this.timeline).trigger("click")}},_addSocial:function(t,n){var r=this;if(this.social[t].name!=""){this._parseRSS(this.social[t].url[n],this.social[t].limit,n,function(i,s){function p(){if(r.social[t].url.length>=n+1){r._addSocial(t,n+1)}if(s==r.social[t].url.length-1){if(parseInt(t,10)==r.social.length-1){r._output()}else{r._addSocial(t+1,0)}}}var o=i.xmlString;var i=i.feed;if(!i){p();return false}r.nameFeeds[r.totalFeeds]=r.social[t].id;r.iconFeeds[r.totalFeeds]=r.social[t].icon;r.limitFeeds[r.totalFeeds]=r.social[t].limit;r.totalFeeds++;for(var u=0;u<i.entries.length;u++){i.entries[u].name=r.social[t].id;i.entries[u].icon=r.social[t].icon;i.entries[u].limit=r.social[t].limit;if(typeof o!="undefined"){var a=e.parseXML(o),f=e(a),l=f.find("enclosure")[u],c=f.find("description")[u+1],h=f.find("guid")[u];if(l){i.entries[u].enclosure=e(l).attr("url");i.entries[u].enclosure_type=e(l).attr("type")}if(h){i.entries[u].guid=e(h).text()}if(c&&i.entries[u].name=="tumblr"){i.entries[u].content=e(c).text()}}i.entries[u].feed_title=i.title;if(i.entries[u].author==""||i.entries[u].author=="Webstagram"){i.entries[u].author=r.social[t].name[s]}if(i.entries[u].title!=""||i.entries[u].contentSnippet!=""||r._strip_tags(i.entries[u].content)!=""){r.entry.push(i.entries[u])}}p()},this.settings.total)}else{if(parseInt(t,10)==this.social.length-1){this._output()}else{this._addSocial(t+1,0)}}},_parseFeeds:function(){this._addSocial(0,0)},_strip_tags:function(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,r=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return e.replace(r,"").replace(n,function(e,n){return t.indexOf("<"+n.toLowerCase()+">")>-1?e:""})},_output:function(){var t=this,n=false,r=false,i,s,o={$dpSocialTimelineLine:"",$dpSocialTimelineFilter:"",$dpSocialTimelineLayout:"",$dpSocialTimelineLineWrap:"",$dpSocialTimelineContent:"",$div:"",showDivider:false,appendFilter:false,appendLayout:false},u,a,f,l,c,h,p,d,v,m=new Array;o.$div=e("<div>").addClass("dpSocialTimeline");o.$dpSocialTimelineLine=e("<div />").addClass("dpSocialTimeline_line");o.$dpSocialTimelineLineWrap=e("<div />").addClass("dpSocialTimeline_lineWrap").append(e(o.$dpSocialTimelineLine));e(o.$div).append(o.$dpSocialTimelineLineWrap);this.entry.sort(function(e,t){e=(new Date(e["publishedDate"])).getTime();t=(new Date(t["publishedDate"])).getTime();return e==t?0:e>t?-1:1});this._createMarkup(o,0,false);e(".dpSocialTimeline_item",o.$div).width(this.settings.itemWidth);if(this.settings.showFilter&&this.totalFeeds>1){o.$dpSocialTimelineFilter=e("<div />").addClass("dpSocialTimeline_filter");for(var g=0;g<=this.totalFeeds;g++){if(typeof this.nameFeeds[g]!=="undefined"&&e.inArray(this.nameFeeds[g],m)===-1){o.$dpSocialTimelineFilter.append(e("<button />").attr({"data-filter":"."+this.nameFeeds[g]}).append(e("<span />").addClass("favicon "+this.nameFeeds[g])));if(typeof this.iconFeeds[g]!="undefined"&&this.iconFeeds[g]!=""){e("."+this.nameFeeds[g],o.$dpSocialTimelineFilter).css("background-image","url("+this.iconFeeds[g]+")")}m[g]=this.nameFeeds[g]}}if(m.length>1){o.appendFilter=true;o.showDivider=true}}if(this.settings.showLayout){o.$dpSocialTimelineLayout=e("<div />").addClass("dpSocialTimeline_layout");if(this.settings.showLayoutTimeline){o.$dpSocialTimelineLayout.append(e("<button />").attr({"data-style":"spineAlign"}).addClass("spineAlign").append(e("<span />")))}if(this.settings.showLayoutColumns){o.$dpSocialTimelineLayout.append(e("<button />").attr({"data-style":"masonry"}).addClass("masonry").append(e("<span />")))}if(this.settings.showLayoutOneColumn){o.$dpSocialTimelineLayout.append(e("<button />").attr({"data-style":"straightDown"}).addClass("straightDown").append(e("<span />")))}o.appendLayout=true;o.showDivider=true}t._onLoadHook(o);if(o.$dpSocialTimelineFilter.length){e("button",o.$dpSocialTimelineFilter).click(function(){if(!e(this).hasClass("active")){e(this).addClass("active")}else{e(this).removeClass("active")}var n="";e(".dpSocialTimeline_item.filtered",o.$div).removeClass("filtered");e("button.active",o.$dpSocialTimelineFilter).each(function(t){if(e(this).attr("data-filter")!=""&&typeof e(this).attr("data-filter")!=="undefined"){if(t>0){n+=","}n+=e(this).attr("data-filter");e(".dpSocialTimeline_item"+e(this).attr("data-filter"),o.$div).addClass("filtered")}});if(n==""){n=".dpSocialTimeline_item:lt("+t.settings.total+")";o.$div.isotope({filter:n});e(".dpSocialTimeline_item:gt("+(t.settings.total-1)+")",o.$div).css({opacity:0,scale:.001,display:"block"})}else{n=".filtered:lt("+t.settings.total+")";o.$div.isotope({filter:n});e(".dpSocialTimeline_item.filtered:gt("+(t.settings.total-1)+")",o.$div).css({opacity:0,scale:.001,display:"none"});e(".dpSocialTimeline_item.filtered:lt("+t.settings.total+")",o.$div).css({opacity:1,scale:1,display:"block"})}return false})}if(this.settings.showLayout){e("button",o.$dpSocialTimelineLayout).click(function(){if(e(this).hasClass("active"))return;e("button",o.$dpSocialTimelineLayout).removeClass("active");e(this).addClass("active");if(e(this).attr("data-style")!=""&&typeof e(this).attr("data-style")!=="undefined"){t.lastLayout=e(this).attr("data-style");switch(e(this).attr("data-style")){case"spineAlign":o.$dpSocialTimelineLineWrap.fadeIn("fast");if(t.settings.timelineItemWidth!=""){e(".dpSocialTimeline_item",o.$div).css("width",t.settings.timelineItemWidth)}else{e(".dpSocialTimeline_item",o.$div).width(t.settings.itemWidthOrig)}break;case"masonry":o.$dpSocialTimelineLineWrap.fadeOut("fast");if(t.settings.columnsItemWidth!=""){e(".dpSocialTimeline_item",o.$div).css("width",t.settings.columnsItemWidth)}else{e(".dpSocialTimeline_item",o.$div).width(t.settings.itemWidthOrig)}break;case"straightDown":o.$dpSocialTimelineLineWrap.fadeOut("fast");if(t.settings.oneColumnItemWidth!=""){e(".dpSocialTimeline_item",o.$div).css("width",t.settings.oneColumnItemWidth)}else{e(".dpSocialTimeline_item",o.$div).width(t.settings.itemWidthOrig)}break}o.$div.isotope({layoutMode:e(this).attr("data-style")});if(e(".dpSocialTimeline_item.filtered",o.$div).length){e(".dpSocialTimeline_item.filtered:gt("+(t.settings.total-1)+")",o.$div).css({opacity:0,scale:.001,display:"none"});e(".dpSocialTimeline_item.filtered:lt("+t.settings.total+")",o.$div).css({opacity:1,scale:1,display:"block"})}else{e(".dpSocialTimeline_item:gt("+(t.settings.total-1)+")",o.$div).css({opacity:0,scale:.001,display:"none"})}}return false})}},_createMarkup:function(t,n,r){for(x=n;x<this.entry.length;x++){if(this.settings.showSocialIcons){$favicon=e("<span />").addClass("favicon "+this.entry[x].name);if(typeof this.entry[x].icon!="undefined"&&this.entry[x].icon!=""){e($favicon).css("background-image","url("+this.entry[x].icon+")")}}else{$favicon=""}date_published=new Date(this.entry[x].publishedDate);published_parse=Date.UTC(date_published.getFullYear(),date_published.getMonth(),date_published.getDate(),date_published.getHours(),date_published.getMinutes());$time=e("<span />").addClass("time").html(this._relativeTime(published_parse));$permalink=e("<a />").addClass("permalink").attr({href:this.entry[x].link,target:"_blank"});if(this.entry[x].link.substr(0,28)=="http://www.youtube.com/watch"){is_youtube=true;this.entry[x].thumbnail="http://i.ytimg.com/vi/"+this._getYoutubeId(this.entry[x].link)+"/0.jpg";is_vimeo=false;$video_icon=e("<div />").addClass("video_icon")}else if(this.entry[x].link.substr(0,16)=="http://vimeo.com"){is_youtube=false;is_vimeo=true;$video_icon=e("<div />").addClass("video_icon")}else{is_youtube=false;is_vimeo=false;$video_icon=""}var i=this.entry[x].author,s=this.entry[x].feed_title,o=this.entry[x].enclosure,u=this.entry[x].guid;if(this.entry[x].name=="flickr"){i=this.entry[x].author.match(/\((.*?)\)/g)[0]}else{i=i.replace(/\((.*?)\)/g,"")}if(this.entry[x].name=="twitter"){i="@"+i}if(this.entry[x].name=="google"){i=s.substr(0,s.indexOf(".")).replace("Public RSS-Feed of ","")}if(this.entry[x].name=="soundcloud"){i=s}t.$dpSocialTimelineContent=e("<div />").addClass("dpSocialTimelineContent");if(this.entry[x].link.indexOf("twitter.com")!==-1){var a=this.entry[x].link.split("/");var f=a[5];title=this._linkify(this.entry[x].title.replace(new RegExp("("+this.preg_quote(i.replace("@","")+": ")+")","gi"),""));e(t.$dpSocialTimelineContent).append(e("<div>").addClass("dpSocialTimelineTwitterActions").append(e("<a>").attr({href:"https://twitter.com/intent/tweet?in_reply_to="+f}).addClass("tw_reply").text("Reply")).append(e("<a>").attr({href:"https://twitter.com/intent/retweet?tweet_id="+f}).addClass("tw_retweet").text("Retweet")).append(e("<a>").attr({href:"https://twitter.com/intent/favorite?tweet_id="+f}).addClass("tw_favorite").text("Favorite")))}else if(this.entry[x].link.indexOf("facebook.com")!==-1||this.entry[x].link.indexOf("pinterest.com")!==-1){this.entry[x].content=this.entry[x].content.replace('rel="nofollow">www','rel="nofollow">http://www');title=this._linkify(this._strip_tags(this.entry[x].content,"<br>, <p>")).replace("<br><br>","");if(title.indexOf("<br>")==0){title=title.substr(4)}if(title==""){title=this._linkify(this.entry[x].title)}}else{title=this._linkify(this.entry[x].title)}if(this.entry[x].name=="tumblr"){if(this.entry[x].content.indexOf("<iframe")!=-1){title=this.entry[x].content}}e(t.$dpSocialTimelineContent).prepend(title);if(this._getImage(this.entry[x],false)!=""){$get_image=this._getImage(this.entry[x],false);$img_link=e("<a />").attr({href:this.entry[x].link,target:"_blank"}).addClass("img_link"+(is_youtube||is_vimeo?" youtube":""));e($img_link).append($get_image).append($video_icon);if(this.settings.addColorbox){e($img_link).addClass("addColorbox");if(is_youtube){e($img_link).attr({href:this._getYoutubeVideo(this.entry[x].link)})}else if(is_vimeo){e($img_link).attr({href:this._getVimeoVideo(this.entry[x].link)})}else{e($img_link).attr({href:this._getImage(this.entry[x],true)})}}t.$dpSocialTimelineContent.append(e("<br />")).append($img_link)}if(this.entry[x].name=="soundcloud"){var l=u.substr(u.lastIndexOf("/")+1);t.$dpSocialTimelineContent.addClass("track-"+l);e.getJSON("http://soundcloud.com/oembed?callback=?",{format:"js",url:u,iframe:true,guid:".track-"+u.substr(u.lastIndexOf("/")+1)},function(n){var r=this.url.substr(this.url.lastIndexOf(".track")).split("&");e(e(t.$div).find(r[0])[0]).append(e("<br />")).append(e("<br />")).append(n["html"]);t.$div.isotope("reLayout")})}var c=jQuery("<a />").addClass("share_twitter").attr({href:"http://twitter.com/share?original_referer="+this.entry[x].link+"&text="+encodeURIComponent(this._strip_tags(title).length>110?this._strip_tags(title).substr(0,110)+"... - ":this._strip_tags(title)),title:"Share in Twitter"}).click(function(e){var t=575,n=400,r=(jQuery(window).width()-t)/2,i=(jQuery(window).height()-n)/2,s=this.href,o="status=1"+",width="+t+",height="+n+",top="+i+",left="+r;window.open(s,"twitter",o);return false}),h=jQuery("<a />").addClass("share_facebook").attr({href:"http://www.facebook.com/share.php?u="+this.entry[x].link,title:"Share in Facebook"}).click(function(e){var t=575,n=400,r=(jQuery(window).width()-t)/2,i=(jQuery(window).height()-n)/2,s=this.href,o="status=1"+",width="+t+",height="+n+",top="+i+",left="+r;window.open(s,"facebook",o);return false});$stContentHead=e("<div />").addClass("dpSocialTimelineContentHead").append(e($favicon)).append(e("<span />").addClass("user").append(e("<strong/>").html(i).text())).append(e($permalink)).append(e("<div />").css("clear","both"));$stContentFoot=e("<div />").addClass("dpSocialTimelineContentFoot").append(e($time)).append(this.settings.share?e(c):"").append(this.settings.share?e(h):"");t.$dpSocialTimelineContent.append(e("<div />").css("clear","both"));$li=e("<div>").addClass((r?"dpSocialTimeline_hideMe ":"")+"dpSocialTimeline_item").addClass(this.entry[x].name).append(e($stContentHead)).append(e(t.$dpSocialTimelineContent)).append(e($stContentFoot)).attr({"data-timeline-time":(new Date(this.entry[x].publishedDate)).getTime()});e(t.$div).append($li)}},_onLoadHook:function(t){var n=this;e(n.timeline).append(e(t.$div).hide());e("img",n.timeline).dpSocialTimeline_batchImageLoad({loadingCompleteCallback:function(){if(t.showDivider){e(n.timeline).prepend(e("<div />").addClass("dpSocialTimeline_divider"))}if(t.appendLayout){e(n.timeline).prepend(t.$dpSocialTimelineLayout)}if(t.appendFilter){e(n.timeline).prepend(t.$dpSocialTimelineFilter)}e(t.$div).show();e(n.timeline).removeClass("dpSocialTimelineLoading");if(n.settings.layoutMode=="spineAlign")e(t.$dpSocialTimelineLineWrap).show();e(t.$div).isotope({itemSelector:".dpSocialTimeline_item",layoutMode:n.settings.layoutMode,itemPositionDataEnabled:true,getSortData:{time:function(e){return e.attr("data-timeline-time")}},sortBy:"time",sortAscending:false,spineAlign:{gutterWidth:20},transformsEnabled:n.settings.rtl?false:true,onLayout:function(n,r){e(t.$dpSocialTimelineLayout).find("button[data-style='"+r.options.layoutMode+"']").addClass("active");e("span",t.$dpSocialTimelineLine).fadeOut("fast",function(){e(this).remove()});n.each(function(n){var r=e("<span />");t.$dpSocialTimelineLine.append(r.css({top:e(this).data("isotope-item-position").y+18}))})}});e(t.$div).isotope({filter:".dpSocialTimeline_item:lt("+n.settings.total+")"});e(".dpSocialTimeline_item:gt("+(n.settings.total-1)+")",t.$div).css({opacity:0,scale:.001});e(".dpSocialTimeline_item",t.$div).width(n.settings.itemWidth);if(n.settings.addColorbox){e(t.$div).find(".addColorbox").colorbox();e(t.$div).find(".addColorbox.youtube").colorbox({iframe:true,innerWidth:425,innerHeight:344})}n._updateTimelineSize()}})},_parseRSS:function(t,n,r,i,s){if(t==null)return false;var o=this.prefix+"ajax.googleapis.com/ajax/services/feed/load?v=1.0&output=json_xml&callback=?&q="+encodeURIComponent(t);if(n!=null&&n>0&&typeof n!="undefined")o+="&num="+n;else if(e.isArray(n))o+="&num="+n[r];else if(s!=null)o+="&num="+s;if(t.indexOf("user_timeline.php")!==-1||t.indexOf("search.php")!==-1){o=t;if(n!=null&&n>0&&typeof n!="undefined")o+="&count="+n;else if(s!=null)o+="&count="+s}e.getJSON(o,function(e){if(typeof i=="function"){try{e.responseData.feed}catch(t){console.log("Feed: "+o+" could not be loaded");i.call(this,false,r);return false}i.call(this,e.responseData,r)}else{return false}})},preg_quote:function(e){return(e+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")},_relativeTime:function(e){var t=e;var n=arguments.length>1?arguments[1]:new Date;var r=parseInt((Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes())-t)/1e3);var i="";if(r<60){i="less than minute ago"}else if(r<120){i="about a minute ago"}else if(r<60*60){i="about "+parseInt(r/60).toString()+" minutes ago"}else if(r<120*60){i="about an hour ago"}else if(r<24*60*60){i="about "+parseInt(r/3600).toString()+" hours ago"}else if(r<48*60*60){i="1 day ago"}else{i=parseInt(r/86400).toString()+" days ago"}return i},_getImage:function(t,n){var r=new Array;var i=/<img .*?src=["\']([^ ^"^\']*)["\']/gi;var s;var o="";var u=t.content;var a=t.title;if(t.thumbnail!=""&&typeof t.thumbnail!=="undefined"){r[0]=t.thumbnail}else{while(s=i.exec(u)){r.push(s[1])}}if(r.length>0&&r[0].indexOf("sndcdn.com")===-1){var f=r[0];if(f.indexOf("instagram.com/profiles")!==-1){f=r[1]}f=f.replace("_m.jpg",".jpg");if(f.indexOf("fbcdn.net/")==-1){f=f.replace("_b.jpg","_f.jpg");f=f.replace("_b.png","_f.png")}else{f=f.replace("_t.jpg","_b.jpg");f=f.replace("_t.png","_b.png")}f=f.replace("_s.jpg","_b.jpg");f=f.replace("_m.png",".png");f=f.replace("_s.png","_b.png");f=f.replace("&","&");if(f.indexOf("safe_image.php")!=-1){f=unescape(f.match(/url=([^&]+)/)[1])}if(f.indexOf("app_full_proxy.php")!=-1){f=unescape(f.match(/src=([^&]+)/)[1])}o=(this.settings.itemWidth!=""?this.settings.itemWidth:200)-40;if(n){return f}else{return e("<img />").attr({src:f,alt:a}).addClass("item_thumb").css({width:"98%"})}}else{return false}},_getYoutubeVideo:function(e){return e.replace(/http:\/\/(www.)?(youtu.be\/|youtube.com\/watch\?v=)([a-zA-Z0-9?%.;:\\/=+_-]+)([&]*([a-zA-Z0-9?&%.;:\\/=+_-]*))/i,"http://www.youtube.com/v/$3?fs=1&hl=en_US")},_getYoutubeId:function(e){var t=/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/;var n=e.match(t);if(n&&n[1].length==11){return n[1]}return false},_getVimeoVideo:function(e){return e.replace(/http:\/\/(www.)?(vimeo.com\/)([a-zA-Z0-9?%.;:\\/=+_-]+)([&]*([a-zA-Z0-9?&%.;:\\/=+_-]*))/i,"http://player.vimeo.com/video/$3")},_linkify:function(e){return e.replace(/(\b((https?|ftp|file):\/\/|(www.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,function(e){if(e.indexOf("://")===-1){e="http://"+e}return'<a href="'+e+'" target="_blank">'+e+"</a>"})}};e.fn.dpSocialTimeline=function(n){var r;this.each(function(){r=new t(e(this),n);e(this).data("dpSocialTimeline",r)});return this};e.fn.dpSocialTimeline.defaults={feeds:null,layoutMode:"timeline",addColorbox:false,showSocialIcons:true,showFilter:true,showLayout:true,showLayoutTimeline:true,showLayoutColumns:true,rtl:false,showLayoutOneColumn:true,itemWidth:200,share:true,timelineItemWidth:"",columnsItemWidth:"",oneColumnItemWidth:"",skin:"light",total:10};e.fn.dpSocialTimeline.settings={};e.Isotope.prototype._spineAlignReset=function(){this.spineAlign={colA:0,colB:10}};e.Isotope.prototype._spineAlignLayout=function(t){var n=this,r=this.spineAlign,i=Math.round(this.options.spineAlign&&this.options.spineAlign.gutterWidth)||0,s=Math.round(this.element.width()/2);t.each(function(){var t=e(this),o=r.colB>r.colA,u=o?s-(t.outerWidth(true)+i/2):s+i/2,a=o?r.colA:r.colB;n._pushPosition(t,u,a);if(o){t.removeClass("colB").addClass("colA")}else{t.removeClass("colA").addClass("colB")}r[o?"colA":"colB"]+=t.outerHeight(true)})};e.Isotope.prototype._spineAlignGetContainerSize=function(){var e={};e.height=this.spineAlign[this.spineAlign.colB>this.spineAlign.colA?"colB":"colA"];return e};e.Isotope.prototype._spineAlignResizeChanged=function(){return true};e.Isotope.prototype._positionAbs=function(e,t){return{right:e,top:t}};e.fn.dpSocialTimeline_batchImageLoad=function(t){var n=e(this);var r=n.size();var i=r;var s=0;e.fn.dpSocialTimeline_batchImageLoad.defaults={loadingCompleteCallback:null,imageLoadedCallback:null};var o=e.extend({},e.fn.dpSocialTimeline_batchImageLoad.defaults,t);n.each(function(){if(e(this)[0].complete){i--;if(o.imageLoadedCallback)o.imageLoadedCallback(s,r)}else{e(this).load(function(){s++;if(o.imageLoadedCallback)o.imageLoadedCallback(s,r);if(s>=i)if(o.loadingCompleteCallback)o.loadingCompleteCallback()});e(this).error(function(){s++;if(o.imageLoadedCallback)o.imageLoadedCallback(s,r);if(s>=i)if(o.loadingCompleteCallback)o.loadingCompleteCallback()})}});if(i<=0)if(o.loadingCompleteCallback)o.loadingCompleteCallback()}})(jQuery)